<html>
  <head>

    <can-import from="sr-careplanner/blaze.min.css" />
    <can-import from="sr-careplanner/blaze.animations.min.css" />
    <can-import from="sr-careplanner/font-awesome/css/font-awesome.css" />
    <can-import from="sr-careplanner/styles.less!" />
    <can-import from="sr-careplanner/app" export-as="viewModel" />

    <can-import from="sr-careplanner/decorations/main-header/" />
    <can-import from="sr-careplanner/decorations/main-footer/" />
    <can-import from="sr-careplanner/user/editor/" />
	<can-import from="sr-careplanner/account/login/" />
	<can-import from="sr-careplanner/account/login/permissionMaster/" />
	
    <title>{{title}}</title>
  </head>
  <body>
  
{{simpleRoute}}
{{confirmEmail}}
{{#confirmEmailMessage}}
<div class='confirmEmailStatusContainer {{confirmEmailStatus}}'> <div class='confirmEmailMessage'>{{confirmEmailMessage}}</div></div>
{{/confirmEmailMessage}}


			
<account-login-permission-master/>
    <div id='workingContainer'>
{{#if session.get('role')}}
    <main-header/>
    		
	{{#unconfirmedEmailAddress}}
	<div class='unconfirmedEmailAddressNotification'>Email address ({{unconfirmedEmailAddress}}) has not been confirmed. Click <span class='resend' ($click)='resendConfirmation()'>HERE</span> to resend confirmation email (or check your spam filter).</div>
	{{/unconfirmedEmailAddress}}

	{{#showResendNotification}}
	<div class='c-overlay showResendNotificationContainer' style=''>
	
		<div class='showResendNotificationMessage'>
		<div>Confirmation Email Message Sent to:<br/><br/>
		<div style='margin-left:20px;font-weight:normal;'>{{unconfirmedEmailAddress}}</div>
		<br/>
		Please remember to check your spam mailbox.<br/><br/>
		<div style='font-size:80%;'>(If your mail program supports it, you can search for<br/><br/>
		<div style='margin-left:20px;font-weight:normal;'>{{systemProdName}} Confirmation Request</div><br/>
		in the mail subject.)</div>
		<div>
		</div>
	
	</div>
	{{/showResendNotification}}

	{{#switch page}}      
		{{#case "admin"}}
		<can-import from="sr-careplanner/user/admin/" />
			  <user-admin/>
		{{/case}}
	   
		{{#case "editor"}}
		<can-import from="sr-careplanner/user/editor/" />
			  <user-editor/>
		{{/case}}
	   
		{{#case "nurse"}}
		<can-import from="sr-careplanner/user/nurse/" />
			  <user-nurse/>
		{{/case}}
	   
		{{#case "setup"}}
		<can-import from="sr-careplanner/setup/" />
			  <setup
			  	session='{session}'
			  />
		{{/case}}
	   
		{{#case "help"}}
		<can-import from="sr-careplanner/help/" />
			  <help/>
		{{/case}}
		
		{{#default}}


	{{#switch session.get('role')}}      
		{{#case "admin"}}
		<!--
		<can-import from="sr-careplanner/user/admin/" />
			  <user-admin/>
		-->
		<can-import from="sr-careplanner/user/nurse/" />
			  <user-nurse/>
		{{/case}}
	   
		{{#case "editor"}}
		<can-import from="sr-careplanner/user/editor/" />
			  <user-editor/>
		{{/case}}
	   
		{{#case "nurse"}}
		<can-import from="sr-careplanner/user/nurse/" />
			  <user-nurse/>
		{{/case}}
	{{/switch}}





		{{/default}}
		
	 {{/switch}} 
 
{{else}}
	  {{#slug}}
		{{#switch slug}}
		  {{#case 'register'}}
			<can-import from="sr-careplanner/account/register/" />
				  <account-register/>
		  {{/case}}
		  {{#case 'login'}}
				  <account-login/>
		  {{/case}}
		  {{#case 'forgot-password'}}
				<can-import from="sr-careplanner/account/forgot-password/" />
				  <account-forgot-password/>
		  {{/case}}
		  {{#case 'change-password'}}
				<can-import from="sr-careplanner/account/change-password/" />
				<account-change-password/>
		  {{/case}}
		{{/switch}}
	  {{else}}
		<account-login/>
	  {{/slug}}
{{/if}}  
    

    <main-footer></main-footer>
<button ($click)='testElement("x")' style='margin-left:20px;' tabindex='-1'>test AppViewModel</button>


{{#is session.get('username') 'tqwhite'}}
 	<div style='position:static;bottom:15px;left:50px;'>
 	

		<button ($click)='reinitializeDb("student")' style='' tabindex='-1'>reinitialize student db</button>
		<button ($click)='reinitializeDb("boilerplate")' style='margin-left:20px;' tabindex='-1'>reinitialize boilerplate db</button>
		<button ($click)='reinitializeDb("plan")' style='margin-left:20px;' tabindex='-1'>reinitialize plan db</button>
		<button ($click)='reinitializeDb("user")' style='margin-left:20px;' tabindex='-1'>reinitialize user db</button>

		<button ($click)='clearConsole()' style='margin-left:20px;' tabindex='-1'>clearConsole</button>
	</div> 
{{/is}}	

    {{#switch env.NODE_ENV}}
      {{#case "production"}}
        <script src="{{joinBase 'node_modules/steal/steal.production.js'}}"  main="sr-careplanner/index.stache!done-autorender"></script>
      {{/case}}
      {{#default}}
        <script src="/node_modules/steal/steal.js"></script>
      {{/default}}
    {{/switch}} 
  </body>
</html>
