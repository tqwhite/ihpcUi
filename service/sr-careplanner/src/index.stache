<html>
  <head>

    <can-import from="sr-careplanner/blaze.min.css" />
    <can-import from="sr-careplanner/blaze.animations.min.css" />
    <can-import from="sr-careplanner/font-awesome/css/font-awesome.css" />
    <can-import from="sr-careplanner/styles.less!" />
    <can-import from="sr-careplanner/app" export-as="viewModel" />

    <can-import from="sr-careplanner/decorations/main-header/" />
    <can-import from="sr-careplanner/decorations/main-footer/" />
    <can-import from="sr-careplanner/user/editor/" />
	<can-import from="sr-careplanner/account/login/" />
	<can-import from="sr-careplanner/account/login/permissionMaster/" />
	
    <title>{{title}}</title>
  </head>
  <body>
  
{{simpleRoute}}
{{confirmEmail}}
{{#confirmEmailMessage}}
<div class='confirmEmailStatusContainer {{confirmEmailStatus}}'> <div class='confirmEmailMessage'>{{confirmEmailMessage}}</div></div>
{{/confirmEmailMessage}}
			
<account-login-permission-master/>
    <div id='workingContainer'>
{{#if session.get('role')}}
    <main-header/>
 <div style='background:url(/src/images/insideDecoration.png) no-repeat;background-size:100% auto;'>   		
	{{#unconfirmedEmailAddress}}
	<div class='unconfirmedEmailAddressNotification'>Email address ({{unconfirmedEmailAddress}}) has not been confirmed. Click <span class='resend' ($click)='resendConfirmation()'>HERE</span> to resend confirmation email (or check your spam filter).</div>
	{{/unconfirmedEmailAddress}}

	{{#showResendNotification}}
	<div class='c-overlay showResendNotificationContainer' style=''>
	
		<div class='showResendNotificationMessage'>
		<div>Confirmation Email Message Sent to:<br/><br/>
		<div style='margin-left:20px;font-weight:normal;'>{{unconfirmedEmailAddress}}</div>
		<br/>
		Please remember to check your spam mailbox.<br/><br/>
		<div style='font-size:80%;'>(If your mail program supports it, you can search for<br/><br/>
		<div style='margin-left:20px;font-weight:normal;'>{{systemProdName}} Email Address Confirmation Request</div><br/>
		in the mail subject.)</div>
		<div>
		</div>
	
	</div>
	{{/showResendNotification}}

	{{#switch page}}      
		{{#case "admin"}}
		<can-import from="sr-careplanner/user/admin/" />
			  <user-admin/>
		{{/case}}
	   
		{{#case "editor"}}
		<can-import from="sr-careplanner/user/editor/" />
			  <user-editor/>
		{{/case}}
	   
		{{#case "nurse"}}
		<can-import from="sr-careplanner/user/nurse/" />
			  <user-nurse/>
		{{/case}}
	   
		{{#case "setup"}}
		<can-import from="sr-careplanner/setup/" />
			  <setup
			  	session='{session}'
			  />
		{{/case}}
	   
		{{#case "help"}}
		<can-import from="sr-careplanner/help/" />
			  <help/>
		{{/case}}
		
		{{#default}}


	{{#switch session.get('role')}}      
		{{#case "admin"}}
		<!--
		<can-import from="sr-careplanner/user/admin/" />
			  <user-admin/>
		-->
		<can-import from="sr-careplanner/user/nurse/" />
			  <user-nurse/>
		{{/case}}
	   
		{{#case "editor"}}
		<can-import from="sr-careplanner/user/editor/" />
			  <user-editor/>
		{{/case}}
	   
		{{#case "nurse"}}
		<can-import from="sr-careplanner/user/nurse/" />
			  <user-nurse/>
		{{/case}}
	{{/switch}}





		{{/default}}
		
	 {{/switch}} 
 </div>
{{else}}
<div style='background:url(/src/images/business-background.jpg) no-repeat; background:size:100% 100%;width:100vw;height:100vh;'>
	  {{#slug}}
		{{#switch slug}}
		  {{#case 'register'}}
			<can-import from="sr-careplanner/account/register/" />
				  <account-register/>
		  {{/case}}
		  {{#case 'login'}}
				  <account-login/>
		  {{/case}}
		  {{#case 'forgot-password'}}
				<can-import from="sr-careplanner/account/forgot-password/" />
				  <account-forgot-password/>
		  {{/case}}
		  {{#case 'change-password'}}
				<can-import from="sr-careplanner/account/change-password/" />
				<account-change-password/>
		  {{/case}}
		{{/switch}}
	  {{else}}
		<account-login/>
	  {{/slug}}
</div>
{{/if}}  
    

    <main-footer></main-footer>


{{#is session.get('username') 'tqwhite'}}
 	<div style='position:static;bottom:15px;left:50px;'>
 	
		<div style='font-size:8pt;color:red;margin-top:30px;'><b>DANGER:</b>these four buttons overwrite the database entirely. It puts it back into the original debugging state with no backup. They will not work on Prod.</div>
		<button ($click)='reinitializeDb("student")' style='' tabindex='-1'>reinitialize student db</button>
		<button ($click)='reinitializeDb("boilerplate")' style='margin-left:20px;' tabindex='-1'>reinitialize boilerplate db</button>
		<button ($click)='reinitializeDb("plan")' style='margin-left:20px;' tabindex='-1'>reinitialize plan db</button>
		<button ($click)='reinitializeDb("user")' style='margin-left:20px;' tabindex='-1'>reinitialize user db</button>

		<button ($click)='clearConsole()' style='margin-left:20px;' tabindex='-1'>clearConsole</button>
	</div> 
{{/is}}	

{{#showSendFeedback}}
  
<div class='centerVertical modalBackground' style=''>

				<div class='modalInset'>

	{{^feedbackResult}}
				Please be as specific as you can. If you are making a bug report or a complaint about
				the program, please tell us exactly what you did, ie, the sequence that led to the 
				problem, what you saw and what you would prefer.
				<br/><br/>
				If you are suggesting a feature or asking a question, please be as thorough as you can.<br/><br/>
				In either case, or if you are just saying Hi, please know that we are very
				grateful for your feedback. If you want us to reply somewhere other than 
				<span style='color:gray;'>{{loginUserDataOnly.emailAddress}},</span> 
				please include that in your message.
				<br/><br/>
				The {{systemProdName}} Team
	{{/feedbackResult}}
	
	{{#feedbackResult}}
		{{{feedbackResult}}}
	{{/feedbackResult}}
				</div>


				<div  style='width:50vw;position:relative'>

					<textarea id='feedbackEntry' class="c-field c-editor" style='height:30vh;' {($value)}="feedbackMessage" placeholder="Tell us what you think" ></textarea>

					<div class='buttonContainer centerHorizontal' style='margin-top:15px;'>
						<button  class="c-button c-button--primary c-button--small" ($click)='cancelSendFeedback()'>Cancel</button>
						<button class="c-button c-button--primary c-button--small" ($click)='sendFeedbackMessage()'>Send</button>
					</div>

				</div>

</div>
{{/showSendFeedback}}

{{#if firstLogin}}

  
<div class='centerVertical modalBackground' style=''>
	<div class='modalInset firstUser'>
		<div class='headline'>
			Welcome to {{systemProdName}}
		</div>
		<div>
			<p>Here are a couple of things that we think you would like to know to start.</p>
			<ul>
				<li>Autosave. The system saves every time you change anything. The actual
					saving occurs when you <i>leave</i> an entry field. That is, when you
					type tab or when you click on something else. You will see a green
					indicator in the upper right corner of whatever you are changing.
				</li>
				<li>
					Help. The word Help in the top, right corner leads to helpful information.
					Right now that includes a short video demonstration (go watch this!) and a button to 
					ask us questions. As users let us know what would be helpful, there
					will be more.
				</li>
				<li>
					Email Confirmation. If you see a red bar at the top of the page, that is because you have 
					not confirmed your email address. This is very important to us because
					it is the only way we know to communicate with you. If you cannot find 
					the email message sent when you registered, there is a link in the red
					bar that will send it again.
				<li>
					Feedback and Questions. There is a button at the bottom left of the app.
					Please use it a <u>lot</u>. This app is new. We are sure there are still
					plenty of bugs left but need your help to find them. We also have a lot 
					of ideas for improvements but are waiting for you to tell us what is important.
					You are the person who has to actually <i>use</i> this thing. Please
					help us make it perfect for your needs.
				</li>
			
			</ul>
		<div class='headline'>
			Good Luck and Keep in Touch,
			<div style='font-size:80%;font-style:italic;'>The {{systemProdName}} Team</div>
			<div style='font-size:60%;color:gray;'>ps, Click anywhere to make this message go away. It will not reappear.</div>
		</div>
		
		<div>
	</div>
</div>

{{activateModal}}
{{/if}}

    {{#switch env.NODE_ENV}}
      {{#case "production"}}
        <script src="{{joinBase 'node_modules/steal/steal.production.js'}}"  main="sr-careplanner/index.stache!done-autorender"></script>
      {{/case}}
      {{#default}}
        <script src="/node_modules/steal/steal.js"></script>
      {{/default}}
    {{/switch}} 
  </body>
</html>
